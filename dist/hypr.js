function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=t(require("react")),r=require("matchit"),o=t(require("picostate")),n=require("react-dom"),i=require("@picostate/react"),a=require("flatted/esm"),c=o({}),u={get state(){return c.state},update:function(t,e){var r="function"==typeof t?t(this.state):t;r=r.replace(window.location.origin,""),c.hydrate({location:r})(function(){e(r)})},replaceState:function(t){this.update(t,function(t){window.history.replaceState({},"",t)})},pushState:function(t,e){this.update(t,function(t){!e&&window.history.pushState({},"",t)})}};var s=function(t){function e(e){var r=this;t.call(this,e),this.state={children:e.children.pop?e.children[0]:e.children},this.currentLocation=e.location,c.listen(function(t){var o=t.location,n=e.router(o),i=n[0],a=n[1];if(o!==r.currentLocation)return i.redirect?u.pushState(i.redirect.to):void e.resolve({location:o,params:a,route:i},function(t){r.setState({children:t})})})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentDidMount=function(){window.addEventListener("popstate",function(t){t.target.window&&u.pushState(t.target.location.href,!0)})},e.prototype.render=function(){return this.state.children},e}(e.Component);var l=o({});exports.client=function(t,o,c){void 0===o&&(o={}),void 0===c&&(c={});var p=window.location.href.replace(window.location.origin,""),d=function(t,e){void 0===e&&(e=[]);var o=t.map(function(t){return r.parse(t[0])}),n=t.reduce(function(t,e){return t[e[0]]=e[1],t},{});return function(t){var e=r.match(t,o);return e.length?[n[e[0].old],r.exec(t,e)]:[]}}(t.map(function(t){return[t.pathname,function(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&-1===e.indexOf(o)&&(r[o]=t[o]);return r}(t,["pathname"])]})),f=d(p),h=f[0],v=f[1],m=a.parse(JSON.stringify(window.__hypr));return l.hydrate(Object.assign({},m,o,{router:{location:p,params:v}})),function(t){n.hydrate(e.createElement(s,{router:d,location:p,resolve:function(t,e){var r=t.route;l.hydrate({router:{location:t.location,params:t.params}});var o=r.load;void 0===o&&(o=function(){}),Promise.resolve(o(l.state)).then(function(t){var o=t.redirect,n=t.meta,i=t.props;if(o)return u.pushState(o.to);l.hydrate(i),Promise.resolve(c.resolve&&c.resolve(l.state)).then(function(){document.title=n.title||document.title,e(r.view(l.state))}).catch(function(t){console.log("options.resolve failed")})}).catch(function(t){console.log("route.load failed")})}},e.createElement(i.Provider,{store:l},h.view(l.state))),t)}};
//# sourceMappingURL=hypr.js.map
