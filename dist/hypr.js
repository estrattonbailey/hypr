var e,t=(e=require("picostate"))&&"object"==typeof e&&"default"in e?e.default:e;require("html-meta-tags");var r=require("hyperapp-render"),n=require("foil"),a=require("superfine"),o=t({}),i=t({});function s(e,t,r){return"\n    <!DOCTYPE html>\n    <html lang='en'>\n      <head>\n        <script>console.log('so nice')<\/script>\n        <meta charset='utf-8'>\n        <meta http-equiv='X-UA-Compatible' content='IE=edge'>\n        <meta name='viewport' content='width=device-width,initial-scale=1'>\n        <link rel=\"icon\" type=\"image/png\" sizes=\"32x32\" href=\"/static/favicon.png\">\n        <link rel='canonical' href='so-nice.site'>\n        <title>"+t.title+"</title>\n        "+require("html-meta-tags")(t)+"\n      </head>\n\n      <body>\n        <div id='root'>"+r+"</div>\n        <script>\n          window.__hypr = {\n            app: "+JSON.stringify(e)+"\n          }\n        <\/script>\n      </body>\n    </html>\n  "}process;function l(e,t,r){e.writeHead(r||302,{Location:t.to,Referer:t.from}),e.end()}exports.h=a.h,exports.server=function(e,t){var a=n.router(e.map(function(e){return n.route({path:e.path,payload:{load:e.load,view:e.view}})}));return function(e,t){var n=a.resolve(e.url),o=n.payload,c=n.redirect,d=n.context;return o?c&&c.to?l(t,c):(i.hydrate({router:d}),t.setHeader("Content-Type","text/html"),Promise.resolve(o.load({req:e,state:i.state})||{}).then(function(e){var n=e.redirect,a=e.meta,c=e.state,d=e.server;if(void 0===d&&(d={}),n&&n.to)return l(t,n,u);i.hydrate(c);var p=d.cache,u=d.status;t.setHeader("Cache-Control",!1!==p?"public, max-age="+(p||86400):"no-cache, no-store, must-revalidate"),t.statusCode=u||200;var h=r.renderToString(o.view(i.state));console.log(h),t.end(s(i.state,a,h))}).catch(function(e){var n={title:"500 - Server Error"};i.hydrate({meta:n}),t.statusCode=500,t.end(s(i.state,n,r.renderToString(o.view(i.state)))),function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];console.log.apply(console,e)}(e)})):(t.statusCode=404,void t.end())}},exports.client=function(e,t,r){var s=n.router(e.map(function(e){return n.route({path:e.path,payload:{load:e.load,view:e.view}})})).resolve(req.url),l=s.context;function c(e,t){t=a.patch(t,o.state.payload.view(e),r)}o.hydrate({payload:s.payload,context:l}),i.hydrate({router:l}),i.hydrate(window.__hypr.app),i.listen(c),o.listen(function(e){c(i.state)}),c(i.state)};
//# sourceMappingURL=hypr.js.map
