function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=require("matchit"),r=t(require("react")),n=t(require("picostate")),o=require("@picostate/react"),a=t(require("nanoclass")),i=require("react-dom"),c=require("flatted/esm");var u=n({});function s(t,e){var r="function"==typeof t?t(u.state):t;r=r.replace(window.location.origin,""),u.hydrate({location:r})(function(){e(r)})}var l={get state(){return u.state},replaceState:function(t){s(t,function(t){window.history.replaceState({},"",t)})},pushState:function(t,e){s(t,function(t){!e&&window.history.pushState({},"",t)})}};var d=createStore({});var f=function(t){function e(e){var r=this;t.call(this,e),this.state={children:e.children.pop?e.children[0]:e.children},this.currentLocation=e.location,u.listen(function(t){var n=t.location,o=e.router(n),a=o[0],i=o[1];if(n!==r.currentLocation)return a.redirect?l.pushState(a.redirect.to):void e.resolve({location:n,params:i,route:a},function(t){r.currentLocation=n,r.setState({children:t})})})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentDidMount=function(){window.addEventListener("popstate",function(t){t.target.window&&l.pushState(t.target.location.href,!0)})},e.prototype.render=function(){return this.state.children},e}(r.Component);exports.client=function(t,n,a){void 0===n&&(n={}),void 0===a&&(a={});var u=window.location.href.replace(window.location.origin,""),s=function(t,r){void 0===r&&(r=[]);var n=t.map(function(t){return e.parse(t[0])}),o=t.reduce(function(t,e){return t[e[0]]=e[1],t},{});return function(t){var r=e.match(t,n);return r.length?[o[r[0].old],e.exec(t,r)]:[]}}(t.map(function(t){return[t.pathname,function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(r[n]=t[n]);return r}(t,["pathname"])]})),p=s(u),h=p[0],v=p[1],m=c.parse(JSON.stringify(window.__hypr));return d.hydrate(Object.assign({},m,n,{router:{location:u,params:v}})),function(t){i.hydrate(r.createElement(f,{router:s,location:u,resolve:function(t,e){var r=t.route;d.hydrate({router:{location:t.location,params:t.params}});var n=r.load;void 0===n&&(n=function(){}),Promise.resolve(n(d.state)).then(function(t){var n=t.redirect,o=t.meta,i=t.props;if(n)return l.pushState(n.to);d.hydrate(i),Promise.resolve(a.resolve&&a.resolve(d.state)).then(function(){document.title=o.title||document.title,e(r.view(d.state))}).catch(function(t){console.log("options.resolve failed")})}).catch(function(t){console.log("route.load failed")})}},r.createElement(o.Provider,{store:d},h.view(d.state))),t)}},exports.withHistory=function(t){return function(e){return r.createElement(t,Object.assign({},{history:l},e))}},exports.history=l,exports.withState=function(t){return function(e){return o.connect(t)(e)}},exports.store=d,exports.Link=function(t){var e=t.children,n=t.href,o=t.className,i=t.target,c=t.download,u=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(r[n]=t[n]);return r}(t,["children","href","className","target","download"]),s=a([o,l.location===n&&"active"]),d={};return i&&(d.target=i),c&&(d.download=c),r.createElement("a",Object.assign({},{href:n,className:s,onClick:function(t){t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.defaultPrevented||"_blank"===d.target||d.download||/mailto|tel/.test(n)||/^(https?:)?\/\//.test(n)||(t.preventDefault(),l.pushState(n))}},d,u),e)},exports.Router=f;
//# sourceMappingURL=hypr.js.map
