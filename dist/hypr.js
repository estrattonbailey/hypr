function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=e(require("picostate"));require("html-meta-tags");var r=e(require("react")),n=require("react-dom/server"),a=require("foil"),o=require("@foil/react"),i=require("@picostate/react"),c=require("react-dom"),l=t({}),d=t({});function s(e,t,r){return"\n    <!DOCTYPE html>\n    <html lang='en'>\n      <head>\n        <meta charset='utf-8'>\n        <meta http-equiv='X-UA-Compatible' content='IE=edge'>\n        <meta name='viewport' content='width=device-width,initial-scale=1'>\n        <link rel=\"icon\" type=\"image/png\" sizes=\"32x32\" href=\"/static/favicon.png\">\n        <link rel='canonical' href='so-nice.site'>\n        <title>"+t.title+"</title>\n        "+require("html-meta-tags")(t)+"\n      </head>\n\n      <body>\n        <div id='root'>"+r+"</div>\n        <script>\n          window.__hypr = {\n            app: "+JSON.stringify(e)+"\n          }\n        <\/script>\n        <script src='/index.js'><\/script>\n      </body>\n    </html>\n  "}process;function u(e,t,r){e.writeHead(r||302,{Location:t.to,Referer:t.from}),e.end()}exports.server=function(e,t){var c=a.router(e.map(function(e){return a.route({path:e.path,payload:{load:e.load,view:e.view}})}));return function(e,t){var a=c.resolve(e.url),l=a.payload,p=a.redirect,v=a.context;return l?p&&p.to?u(t,p):(d.hydrate({router:v}),t.setHeader("Content-Type","text/html"),Promise.resolve(l.load({req:e,state:d.state})||{}).then(function(e){var a=e.redirect,p=e.meta,h=e.state,m=e.server;if(void 0===m&&(m={}),a&&a.to)return u(t,a,y);d.hydrate(h);var f=m.cache,y=m.status;t.setHeader("Cache-Control",!1!==f?"public, max-age="+(f||86400):"no-cache, no-store, must-revalidate"),t.statusCode=y||200;var w=n.renderToString(r.createElement(o.Router,{router:c,context:v,resolve:function(e,t){t(e.payload.view)}},r.createElement(i.Provider,{store:d},r.createElement(l.view,d.state))));t.end(s(d.state,p,w))}).catch(function(e){var r={title:"500 - Server Error"};d.hydrate({meta:r}),t.statusCode=500,t.end(s(d.state,r,"404")),function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];console.log.apply(console,e)}(e)})):(t.statusCode=404,void t.end())}},exports.client=function(e,t){return function(n){var s=a.router(e.map(function(e){return a.route({path:e.path,payload:{load:e.load,view:e.view}})})),u=s.resolve(window.location.pathname),p=u.payload,v=u.context;l.hydrate({payload:p,context:v}),d.hydrate({router:v}),d.hydrate(window.__hypr.app),c.hydrate(r.createElement(o.Router,{router:s,context:v,resolve:function(e,t){t(e.payload.view)}},r.createElement(i.Provider,{store:d},r.createElement(p.view,t))),n)}};
//# sourceMappingURL=hypr.js.map
