!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("matchit"),require("picostate"),require("react-dom"),require("@picostate/react"),require("flatted/esm")):"function"==typeof define&&define.amd?define(["exports","react","matchit","picostate","react-dom","@picostate/react","flatted/esm"],e):e(t.hypr={},t.react,t.matchit,t.picostate,t.reactDom,t.react,t.esm)}(this,function(t,e,o,r,n,i,a){e=e&&e.hasOwnProperty("default")?e.default:e;var c=(r=r&&r.hasOwnProperty("default")?r.default:r)({}),u={get state(){return c.state},update:function(t,e){var o="function"==typeof t?t(this.state):t;o=o.replace(window.location.origin,""),c.hydrate({location:o})(function(){e(o)})},replaceState:function(t){this.update(t,function(t){window.history.replaceState({},"",t)})},pushState:function(t,e){this.update(t,function(t){!e&&window.history.pushState({},"",t)})}};var s=function(t){function e(e){var o=this;t.call(this,e),this.state={children:e.children.pop?e.children[0]:e.children},this.currentLocation=e.location,c.listen(function(t){var r=t.location,n=e.router(r),i=n[0],a=n[1];if(r!==o.currentLocation)return i.redirect?u.pushState(i.redirect.to):void e.resolve({location:r,params:a,route:i},function(t){o.setState({children:t})})})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentDidMount=function(){window.addEventListener("popstate",function(t){t.target.window&&u.pushState(t.target.location.href,!0)})},e.prototype.render=function(){return this.state.children},e}(e.Component);var d=r({});t.client=function(t,r,c){void 0===r&&(r={}),void 0===c&&(c={});var p=window.location.href.replace(window.location.origin,""),l=function(t,e){void 0===e&&(e=[]);var r=t.map(function(t){return o.parse(t[0])}),n=t.reduce(function(t,e){return t[e[0]]=e[1],t},{});return function(t){var e=o.match(t,r);return e.length?[n[e[0].old],o.exec(t,e)]:[]}}(t.map(function(t){return[t.pathname,function(t,e){var o={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===e.indexOf(r)&&(o[r]=t[r]);return o}(t,["pathname"])]})),f=l(p),h=f[0],v=f[1],m=a.parse(JSON.stringify(window.__hypr));return d.hydrate(Object.assign({},m,r,{router:{location:p,params:v}})),function(t){n.hydrate(e.createElement(s,{router:l,location:p,resolve:function(t,e){var o=t.route;d.hydrate({router:{location:t.location,params:t.params}});var r=o.load;void 0===r&&(r=function(){}),Promise.resolve(r(d.state)).then(function(t){var r=t.redirect,n=t.meta,i=t.props;if(r)return u.pushState(r.to);d.hydrate(i),Promise.resolve(c.resolve&&c.resolve(d.state)).then(function(){document.title=n.title||document.title,e(o.view(d.state))}).catch(function(t){console.log("options.resolve failed")})}).catch(function(t){console.log("route.load failed")})}},e.createElement(i.Provider,{store:d},h.view(d.state))),t)}}});
//# sourceMappingURL=hypr.umd.js.map
