!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("matchit"),require("react"),require("picostate"),require("@picostate/react"),require("nanoclass"),require("react-dom"),require("flatted/esm")):"function"==typeof define&&define.amd?define(["exports","matchit","react","picostate","@picostate/react","nanoclass","react-dom","flatted/esm"],e):e(t.hypr={},t.matchit,t.react,t.picostate,t.react,t.nanoclass,t.reactDom,t.esm)}(this,function(t,e,o,r,n,a,i,c){o=o&&o.hasOwnProperty("default")?o.default:o,r=r&&r.hasOwnProperty("default")?r.default:r,a=a&&a.hasOwnProperty("default")?a.default:a;var u=r({});function s(t,e){var o="function"==typeof t?t(u.state):t;o=o.replace(window.location.origin,""),u.hydrate({location:o})(function(){e(o)})}var l={get state(){return u.state},replaceState:function(t){s(t,function(t){window.history.replaceState({},"",t)})},pushState:function(t,e){s(t,function(t){!e&&window.history.pushState({},"",t)})}},d=createStore({}),p=function(t){function e(e){var o=this;t.call(this,e),this.state={children:e.children.pop?e.children[0]:e.children},this.currentLocation=e.location,u.listen(function(t){var r=t.location,n=e.router(r),a=n[0],i=n[1];if(r!==o.currentLocation)return a.redirect?l.pushState(a.redirect.to):void e.resolve({location:r,params:i,route:a},function(t){o.currentLocation=r,o.setState({children:t})})})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentDidMount=function(){window.addEventListener("popstate",function(t){t.target.window&&l.pushState(t.target.location.href,!0)})},e.prototype.render=function(){return this.state.children},e}(o.Component);t.client=function(t,r,a){void 0===r&&(r={}),void 0===a&&(a={});var u=window.location.href.replace(window.location.origin,""),s=function(t,o){void 0===o&&(o=[]);var r=t.map(function(t){return e.parse(t[0])}),n=t.reduce(function(t,e){return t[e[0]]=e[1],t},{});return function(t){var o=e.match(t,r);return o.length?[n[o[0].old],e.exec(t,o)]:[]}}(t.map(function(t){return[t.pathname,function(t,e){var o={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===e.indexOf(r)&&(o[r]=t[r]);return o}(t,["pathname"])]})),f=s(u),h=f[0],m=f[1],v=c.parse(JSON.stringify(window.__hypr));return d.hydrate(Object.assign({},v,r,{router:{location:u,params:m}})),function(t){i.hydrate(o.createElement(p,{router:s,location:u,resolve:function(t,e){var o=t.route;d.hydrate({router:{location:t.location,params:t.params}});var r=o.load;void 0===r&&(r=function(){}),Promise.resolve(r(d.state)).then(function(t){var r=t.redirect,n=t.meta,i=t.props;if(r)return l.pushState(r.to);d.hydrate(i),Promise.resolve(a.resolve&&a.resolve(d.state)).then(function(){document.title=n.title||document.title,e(o.view(d.state))}).catch(function(t){console.log("options.resolve failed")})}).catch(function(t){console.log("route.load failed")})}},o.createElement(n.Provider,{store:d},h.view(d.state))),t)}}});
//# sourceMappingURL=hypr.umd.js.map
