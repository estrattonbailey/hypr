!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("picostate"),require("html-meta-tags"),require("hyperapp-render"),require("foil"),require("superfine")):"function"==typeof define&&define.amd?define(["exports","picostate","html-meta-tags","hyperapp-render","foil","superfine"],t):t(e.hypr={},e.picostate,e.metaTags,e.hyperappRender,e.foil,e.superfine)}(this,function(e,t,r,n,a,o){t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r;var i=t({}),s=t({});function d(e,t,r){return"\n    <!DOCTYPE html>\n    <html lang='en'>\n      <head>\n        <script>console.log('so nice')<\/script>\n        <meta charset='utf-8'>\n        <meta http-equiv='X-UA-Compatible' content='IE=edge'>\n        <meta name='viewport' content='width=device-width,initial-scale=1'>\n        <link rel=\"icon\" type=\"image/png\" sizes=\"32x32\" href=\"/static/favicon.png\">\n        <link rel='canonical' href='so-nice.site'>\n        <title>"+t.title+"</title>\n        "+require("html-meta-tags")(t)+"\n      </head>\n\n      <body>\n        <div id='root'>"+r+"</div>\n        <script>\n          window.__hypr = {\n            app: "+JSON.stringify(e)+"\n          }\n        <\/script>\n      </body>\n    </html>\n  "}process;function l(e,t,r){e.writeHead(r||302,{Location:t.to,Referer:t.from}),e.end()}e.h=o.h,e.server=function(e,t){var r=a.router(e.map(function(e){return a.route({path:e.path,payload:{load:e.load,view:e.view}})}));return function(e,t){var a=r.resolve(e.url),o=a.payload,i=a.redirect,p=a.context;return o?i&&i.to?l(t,i):(s.hydrate({router:p}),t.setHeader("Content-Type","text/html"),Promise.resolve(o.load({req:e,state:s.state})||{}).then(function(e){var r=e.redirect,a=e.meta,i=e.state,p=e.server;if(void 0===p&&(p={}),r&&r.to)return l(t,r,u);s.hydrate(i);var c=p.cache,u=p.status;t.setHeader("Cache-Control",!1!==c?"public, max-age="+(c||86400):"no-cache, no-store, must-revalidate"),t.statusCode=u||200;var h=n.renderToString(o.view(s.state));console.log(h),t.end(d(s.state,a,h))}).catch(function(e){var r={title:"500 - Server Error"};s.hydrate({meta:r}),t.statusCode=500,t.end(d(s.state,r,n.renderToString(o.view(s.state)))),function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];console.log.apply(console,e)}(e)})):(t.statusCode=404,void t.end())}},e.client=function(e,t,r){var n=a.router(e.map(function(e){return a.route({path:e.path,payload:{load:e.load,view:e.view}})})).resolve(req.url),d=n.context;function l(e,t){t=o.patch(t,i.state.payload.view(e),r)}i.hydrate({payload:n.payload,context:d}),s.hydrate({router:d}),s.hydrate(window.__hypr.app),s.listen(l),i.listen(function(e){l(s.state)}),l(s.state)}});
//# sourceMappingURL=hypr.umd.js.map
