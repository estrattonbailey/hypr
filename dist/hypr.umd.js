!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("picostate"),require("html-meta-tags"),require("react"),require("react-dom/server"),require("foil"),require("@foil/react"),require("@picostate/react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","picostate","html-meta-tags","react","react-dom/server","foil","@foil/react","@picostate/react","react-dom"],t):t(e.hypr={},e.picostate,e.htmlMetaTags,e.react,e.server,e.foil,e.react,e.react$1,e.reactDom)}(this,function(e,t,r,a,n,o,i,c,d){t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,a=a&&a.hasOwnProperty("default")?a.default:a;var l=t({}),s=t({});function u(e,t,r){return"\n    <!DOCTYPE html>\n    <html lang='en'>\n      <head>\n        <meta charset='utf-8'>\n        <meta http-equiv='X-UA-Compatible' content='IE=edge'>\n        <meta name='viewport' content='width=device-width,initial-scale=1'>\n        <link rel=\"icon\" type=\"image/png\" sizes=\"32x32\" href=\"/static/favicon.png\">\n        <link rel='canonical' href='so-nice.site'>\n        <title>"+t.title+"</title>\n        "+require("html-meta-tags")(t)+"\n      </head>\n\n      <body>\n        <div id='root'>"+r+"</div>\n        <script>\n          window.__hypr = {\n            app: "+JSON.stringify(e)+"\n          }\n        <\/script>\n        <script src='/index.js'><\/script>\n      </body>\n    </html>\n  "}process;function p(e,t,r){e.writeHead(r||302,{Location:t.to,Referer:t.from}),e.end()}e.server=function(e,t){var r=o.router(e.map(function(e){return o.route({path:e.path,payload:{load:e.load,view:e.view}})}));return function(e,t){var o=r.resolve(e.url),d=o.payload,l=o.redirect,f=o.context;return d?l&&l.to?p(t,l):(s.hydrate({router:f}),t.setHeader("Content-Type","text/html"),Promise.resolve(d.load({req:e,state:s.state})||{}).then(function(e){var o=e.redirect,l=e.meta,h=e.state,m=e.server;if(void 0===m&&(m={}),o&&o.to)return p(t,o,y);s.hydrate(h);var v=m.cache,y=m.status;t.setHeader("Cache-Control",!1!==v?"public, max-age="+(v||86400):"no-cache, no-store, must-revalidate"),t.statusCode=y||200;var w=n.renderToString(a.createElement(i.Router,{router:r,context:f,resolve:function(e,t){t(e.payload.view)}},a.createElement(c.Provider,{store:s},a.createElement(d.view,s.state))));t.end(u(s.state,l,w))}).catch(function(e){var r={title:"500 - Server Error"};s.hydrate({meta:r}),t.statusCode=500,t.end(u(s.state,r,"404")),function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];console.log.apply(console,e)}(e)})):(t.statusCode=404,void t.end())}},e.client=function(e,t){return function(r){var n=o.router(e.map(function(e){return o.route({path:e.path,payload:{load:e.load,view:e.view}})})),u=n.resolve(window.location.pathname),p=u.payload,f=u.context;l.hydrate({payload:p,context:f}),s.hydrate({router:f}),s.hydrate(window.__hypr.app),d.hydrate(a.createElement(i.Router,{router:n,context:f,resolve:function(e,t){t(e.payload.view)}},a.createElement(c.Provider,{store:s},a.createElement(p.view,t))),r)}}});
//# sourceMappingURL=hypr.umd.js.map
